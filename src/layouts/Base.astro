---
import { ClientRouter } from "astro:transitions";
import { createSchema } from "~/utils/schema";
import Head from "~/layouts/Head.astro";
import SkipToMain from "~/components/ui/SkipToMain.astro";
import Header from "~/components/partials/Header.astro";
import TableOfContentsBtn from "~/components/ui/TableOfContentsBtn.astro";
import ScrollToTop from "~/components/ui/ScrollToTop.astro";
import Footer from "~/components/partials/Footer.astro";

const { authorData, description, loadingOptions, postData, schemaType, tableOfContents, title } =
  Astro.props;

const pageUrl = new URL(Astro.url.pathname, Astro.site);

const schema = createSchema(authorData, description, pageUrl, postData, schemaType, title);
---

<!doctype html>
<html lang="en-GB">
  <Head description={description} loadingOptions={loadingOptions} title={title}>
    <script is:inline type="application/ld+json" set:html={JSON.stringify(schema)} />
    <ClientRouter />
  </Head>

  <body
    class="text-mikado-900 bg-mikado-50 grid grid-cols-1 font-serif text-base md:h-screen md:grid-cols-3 md:grid-rows-[auto_1fr_auto] md:overflow-hidden"
  >
    <SkipToMain />
    <Header />
    <main
      id="main"
      class="col-span-2 row-span-3 overflow-y-scroll px-4 pt-8 md:px-8 md:pt-12"
      data-pagefind-body
    >
      {tableOfContents && <TableOfContentsBtn />}
      <slot />
    </main>
    <ScrollToTop />
    <Footer />
  </body>
</html>
