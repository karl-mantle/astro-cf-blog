---
import type { ImageMetadata } from "astro";
import type { HTMLAttributes } from "astro/types";
import { Picture } from "astro:assets";
import { slugify } from "~/utils/collections";
import Button from "~/components/ui/Button.astro";
import Date from "~/components/ui/Date.astro";

interface Props extends HTMLAttributes<"header"> {
  category: string;
  date: Date;
  description: string;
  heading: string;
  image?: {
    alt: string | null;
    src: ImageMetadata;
  };
}

const { category, date, heading, image }: Props = Astro.props;
---

<header class="flex flex-col gap-4">
  {
    image && (
      <Picture
        src={image.src}
        widths={[480, 960]}
        sizes={`(max-width: 640px) 480px`}
        inferSize
        formats={["webp"]}
        loading="lazy"
        class="aspect-video object-cover md:mb-4"
        alt={image.alt ?? ""}
      />
    )
  }

  <h1 class="border-mikado-500 border-b pb-4 text-2xl font-semibold md:text-4xl">{heading}</h1>

  <div class="flex items-center gap-1 text-sm">
    <Date date={date} />
    <span>|</span>
    <Button href={`${Astro.site}posts/category/${slugify(category)}`} label={category} />
  </div>
</header>
