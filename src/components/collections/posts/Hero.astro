---
import type { ImageMetadata } from "astro";
import type { HTMLAttributes } from "astro/types";
import { Picture } from "astro:assets";
import { collectionsConfig, imagesConfig } from "~/site.config";
import slugify from "slugify";
import Date from "~/components/ui/Date.astro";
import TextBtn from "~/components/ui/buttons/TextBtn.astro";

interface Props extends HTMLAttributes<"header"> {
  authorId: string;
  category: string;
  date: Date;
  description: string;
  heading: string;
  image?: {
    alt: string | null;
    src: ImageMetadata;
  };
}

const { category, date, heading, image }: Props = Astro.props;
---

<header class="flex flex-col gap-4 md:gap-8">
  {
    image && (
      <Picture
        alt={image.alt ?? ""}
        class="aspect-video object-cover"
        format="webp"
        loading="eager"
        sizes={imagesConfig.third.sizes}
        src={image.src}
        widths={imagesConfig.third.widths}
      />
    )
  }

  <h1 class="border-mikado-500 border-b pb-4">{heading}</h1>

  <div class="flex h-fit items-baseline gap-1 text-sm font-medium">
    <Date class="self-center" date={date} />
    <span>|</span>
    <TextBtn
      href={`${collectionsConfig.permalink_posts_category}${slugify(category, { lower: true })}`}
      label={category}
      data-pagefind-filter={`category:${category}`}
    />
  </div>
</header>
