---
import type { ImageMetadata } from "astro";
import type { HTMLAttributes } from "astro/types";
import { Picture } from "astro:assets";
import { Icon } from "astro-icon/components";
import { imagesConfig } from "~/site.config";
import Date from "~/components/ui/Date.astro";

interface Props extends HTMLAttributes<"li"> {
  date: Date;
  description: string;
  heading: string;
  href: string;
  image?: {
    alt: string | null;
    src: ImageMetadata;
  };
  loading?: "eager" | "lazy";
}

const { date, description, heading, href, image, loading }: Props = Astro.props;
---

<li>
  <a
    class="group/card hover:text-mikado-950 focus-visible:border-mikado-300 focus-visible:bg-focus-color flex flex-grow flex-col-reverse gap-4 border-2 border-transparent focus-visible:border-2 focus-visible:text-black lg:flex-row-reverse dark:hover:text-white"
    href={href}
  >
    <div class="flex h-fit gap-2 lg:gap-0 lg:p-2">
      <span class="lg:hidden" aria-hidden="true">Read more</span>
      <Icon
        name="material-symbols:arrow-right-alt"
        height={24}
        width={24}
        class="shrink-0 transition-transform duration-300 group-hover/card:-rotate-45 group-focus/card:-rotate-45"
      />
    </div>

    <div class="flex flex-grow flex-col gap-2 text-sm">
      <h3 class="border-mikado-500 border-b pb-2">
        {heading}
      </h3>
      <Date date={date} />
      <p>{description}</p>
    </div>

    {
      image && (
        <Picture
          alt={image.alt ?? ""}
          class="aspect-video object-cover opacity-75 transition-opacity duration-300 group-hover/card:opacity-100 group-focus-visible/card:opacity-100 lg:h-fit lg:max-w-48"
          format="webp"
          loading={loading ?? "lazy"}
          sizes={imagesConfig.third.sizes}
          src={image.src}
          widths={imagesConfig.third.widths}
        />
      )
    }
  </a>
</li>
